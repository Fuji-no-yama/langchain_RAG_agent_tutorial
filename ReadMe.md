# AIエージェントwebアプリ (langchain)
## 概要
langchainのagentを用いて[青空文庫](https://www.aozora.gr.jp/index.html)の任意の文書をRAGツールとして使用できるメモリ付きAIエージェントのwebアプリケーションです。また, 補助的なツールとしてweb検索用の「wikipedia」「duck-duck-go」もツールとして使用できます。アプリケーション化の実装はstreamlitを用いて行いました。
(2024年3月26日現在のlangchain最新バージョン(0.1.13)にて動作します。)

## 実行方法
- .devcontainer内に必要な環境が記されているため, dockerコンテナを作成
- .envファイルに必要な情報を記入(openaiのapiキー, モデル名, モデルtemperature)
- `streamlit run multi_agent.py` にて実行
- ローカルホストで起動するので[ここにアクセス](http://localhost:8501/)
- この状態ではデフォルトで読み込んであるニュートンの伝記についてのRAGとweb検索2種のツールが使える。(「今日の天気は?」などの質問も回答可能)
- RAGの元になる青空文庫の任意のファイルを追加するためには任意の文書のページにおいて「ファイルのダウンロード」-> 「テキストファイル」を選択しダウンロードできるzipファイルを**解凍せずにそのまま**ページに表示されているファイルピッカーに渡す

## 内部動作
### エージェントについて
通常のAIエージェントと同様にプロンプトが入力されるとLLMにツール情報と同時に渡してどのツールを使うべきかを聞き, 指定されたツールがあればローカルで実行してその結果を元に応答を生成してもらう形式です。また, onversationBufferWindowMemoryを用いて直近2つの会話履歴をメモリーとして利用可能になっています。
### RAGツールについて
アップロードされた文書はローカルのDBsディレクトリの中にOpenAI embeddingを用いてベクトル化されて格納されます。この際にはvector DBとしてFAISSを使用しています。また, LLMがどのツールを使用するかを判断するためのツール概要についてはそれ専用のLLMチェーンを作成し文書の概要を抽出してRAGツールを作成しています。
